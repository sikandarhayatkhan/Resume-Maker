head	1.3;
access;
symbols;
locks
	chris:1.3; strict;
comment	@# @;


1.3
date	2017.06.04.14.32.12;	author chris;	state Exp;
branches;
next	1.2;

1.2
date	2017.06.04.13.59.36;	author chris;	state Exp;
branches;
next	1.1;

1.1
date	2017.06.04.13.06.25;	author chris;	state Exp;
branches;
next	;


desc
@vim
@


1.3
log
@(rcsvers.vim) modified outside of vim.
@
text
@/* jshint node: true */
'use strict';

var system = require('system'),
    page = require('webpage').create();

var args = [
    'in',
    'out',
    'cssPath',
    'paperFormat',
    'paperOrientation',
    'paperBorder',
    'renderDelay',
].reduce(function(args, name, i) {
    args[name] = system.args[i+1];
    return args;
}, {});

// (page.open is equivalent to page.onLoadFinished)
page.open(args.in, function(status) {
    if (status == "fail") {
        page.close();
        phantom.exit(1);
        return;
    }

    page.evaluate(function(cssPath) {
        var css = document.createElement('link');
        css.rel = 'stylesheet';
        css.href = cssPath;
        document.querySelector('head').appendChild(css);
    }, args.cssPath);

    page.paperSize = {
        format: args.paperFormat,
        orientation: args.paperOrientation,
        border: args.paperBorder
    };

//    setTimeout(function () {
        page.render(args.out);
        page.close();
        phantom.exit(0);
//    }, 2000); //parseInt(args.renderDelay, 10));
});
@


1.2
log
@(rcsvers.vim) modified outside of vim.
@
text
@d20 1
d45 1
a45 1
//    }, parseInt(args.renderDelay, 10));
@


1.1
log
@vim
@
text
@d5 1
a5 1
   page = require('webpage').create();
d8 7
a14 7
  'in',
  'out',
  'cssPath',
  'paperFormat',
  'paperOrientation',
  'paperBorder',
  'renderDelay',
d16 2
a17 2
  args[name] = system.args[i+1];
  return args;
d21 5
a25 5
  if (status == "fail") {
    page.close();
    phantom.exit(1);
    return;
  }
d27 6
a32 6
  page.evaluate(function(cssPath) {
    var css = document.createElement('link');
    css.rel = 'stylesheet';
    css.href = cssPath;
    document.querySelector('head').appendChild(css);
  }, args.cssPath);
d34 5
a38 5
  page.paperSize = {
    format: args.paperFormat,
    orientation: args.paperOrientation,
    border: args.paperBorder
  };
d40 5
a44 5
  setTimeout(function () {
    page.render(args.out);
    page.close();
    phantom.exit(0);
  }, parseInt(args.renderDelay, 10));
@
